# -*- coding: utf-8 -*-
"""SALES PREDICTION USING PYTHON.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Q3M1bczOEjS4o7l-tfLzIOasHnGJryn9
"""

# Import necessary libraries
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# Load the advertising dataset
url = "/content/advertising.csv"
data = pd.read_csv(url)

# EDA and Data Preprocessing
# Check the first few rows of the dataset
print(data.head())

data.info()

# Check summary statistics
print(data.describe())

# Check for missing values
print(data.isnull().sum())

# Visualize the relationship between TV advertising and sales
plt.figure(figsize=(12, 6))
sns.scatterplot(data=data, x='TV', y='Sales', alpha=0.7)
plt.title('TV Advertising vs. Sales')
plt.xlabel('TV Advertising Budget (in thousands of dollars)')
plt.ylabel('Sales (in thousands of units)')
plt.grid(True)
plt.show()

"""**A scatter plot shows a positive linear relationship between TV advertising budgets and sales. As the TV advertising budget increases, sales tend to increase as well.
The correlation coefficient between TV advertising and sales is calculated to be positive, indicating a moderate positive linear relationship**
"""

# Compute the correlation between TV advertising and sales
correlation = data['TV'].corr(data['Sales'])
print(f"Correlation between TV advertising and sales: {correlation:.2f}")

# Data Splitting
X = data['TV'].values.reshape(-1, 1)  # Feature (TV advertising budget)
y = data['Sales'].values              # Target (sales)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Model Building
model = LinearRegression()
model.fit(X_train, y_train)

"""**A linear regression model is built to predict sales based on TV advertising budgets. The model aims to find the best-fit line that represents the relationship between these two variables.
The model's performance is evaluated using Mean Squared Error (MSE), Root Mean Squared Error (RMSE), and R-squared (R2) metrics.**
"""

# Predictions
y_pred = model.predict(X_test)

# Model Evaluation
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = r2_score(y_test, y_pred)
print(f"Mean Squared Error: {mse:.2f}")
print(f"Root Mean Squared Error: {rmse:.2f}")
print(f"R-squared: {r2:.2f}")

"""**The Mean Squared Error (MSE) measures the average squared difference between predicted and actual sales values. In this case, the MSE is relatively low, indicating that the model provides reasonably accurate predictions.
The Root Mean Squared Error (RMSE) is the square root of MSE. It represents the standard deviation of the errors and is a measure of prediction accuracy. A lower RMSE suggests better model performance.
The R-squared (R2) value is a measure of how well the model explains the variance in the data. A higher R2 value (close to 1) indicates that the model fits the data well. In this case, the R2 value suggests that TV advertising explains a significant portion of the variance in sales.**
"""

# Visualization of the Linear Regression Model
plt.figure(figsize=(12, 6))
plt.scatter(X_test, y_test, color='blue', label='Actual')
plt.plot(X_test, y_pred, color='red', linewidth=2, label='Predicted')
plt.title('Linear Regression Model: TV Advertising vs. Sales')
plt.xlabel('TV Advertising Budget (in thousands of dollars)')
plt.ylabel('Sales (in thousands of units)')
plt.legend()
plt.grid(True)
plt.show()

"""**A scatter plot of actual vs. predicted sales is created to visualize how well the linear regression model fits the data. The red line represents the best-fit line predicted by the model.**

**Based on the analysis, there is a positive relationship between TV advertising budgets and sales. Increasing the TV advertising budget is likely to result in increased sales, to a certain extent.
Businesses can use this insight to make informed decisions regarding their advertising expenditure and optimize their advertising strategies to maximize sales potential.**
"""